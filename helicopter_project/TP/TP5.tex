\documentclass[a4paper,10pt]{article}

\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{color}
\usepackage{amsmath}
\usepackage[francais]{babel}
\usepackage[latin1]{inputenc}
\usepackage{fullpage}
\usepackage{verbatim}
\usepackage{fancyvrb}

\title{TP5 : recherche de l'hélicoptère optimal (1h30)}
\date{14 janvier 2016}
\author{Nicolas Durrande, Rodolphe Le Riche, Victor Picheny}

\begin{document}
\maketitle
\paragraph{Objectif :} effectuer quelques itérations d'EGO afin de trouver la solution optimale.

\section*{Amélioration espérée dans le cas bruité}
L'algorithme EGO n'est pas adapté au krigeage avec observations bruitées. Pour retrouver un compromis exploration / intensification efficace, on utilise un deuxième modèle, dit \textit{réinterpolant}, que l'on construit comme suit :
 \begin{Verbatim}[frame=single,fontsize==\tiny]
pred <- predict(object=model, newdata=model@X, type="UK", checkNames = FALSE)
optim.model <- km(formula=model@trend.formula, design=model@X, response=pred$mean,
    	          covtype=model@covariance@name, coef.trend=model@trend.coef, 
    	          coef.cov=covparam2vect(model@covariance),
    	          coef.var=model@covariance@sd2,control=model@control)
\end{Verbatim}
On peut ensuite utiliser \texttt{optim.model} pour calculer l'amélioration espérée (EI), dont la formule est rappelée ci-dessous (pour 	$x$ un point candidat):
\begin{Verbatim}[frame=single,fontsize==\tiny]
pred <- predict(optim.model, newdata=x, type="UK", checkNames=FALSE)
xcr  <- (min(optim.model@y) - pred$mean)/pred$sd
EI   <- (min(optim.model@y) - pred$mean) * pnorm(xcr) + pred$sd * dnorm(xcr)
\end{Verbatim}

\subsection*{Travail à effectuer}
Ecrivez une fonction qui calcule l'EI compatible avec votre optimiseur CMA-ES. Recherchez le point qui maximise l'EI du modèle réinterpolant, effectuez l'expérience correspondante. Le nouveau point est-il satisfaisant ? Si possible, recommencez plusieurs fois la procédure, en mettant à jour votre krigeage à chaque fois.

\end{document}